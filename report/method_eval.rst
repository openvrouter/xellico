
評価手法に関して
================

ブラックボックスNFテスト方法について
------------------------------------

外部のトラフィック計測器を用いて, VNFを評価する方法について説明する.
本レポートでの性能計測は, 原則として帯域に関して行った.
外部性能計測器はpktge-dpdkを用いて性能計測を行った.
計測はパケットサイズを64,128,192,...,1518と変更しながらそれぞれ
計測を行った. RSSを利用した性能計測を行うため, pktgenはrangeモードを
有効化し, pktgenから流れるトラフィックはそれぞれ別々のRSS Queueに
流れるように行った. ptkgen-dpdkは別途, DPDK用のサーバを用いて行った.
計測は約1分間行い, 一秒ごとの値の平均値を計測値とした.
値のばらつきに関しては研究対象外とする.


内部のマイクロレイテンシ計測について
------------------------------------

DPDKアプリケーションとして呼び出す関数の遅延の計測方法に関して説明する.
遅延計測はTSC (Time Stamp Clock) を用いて計測を行う.
基本的に計測対象は以下のようにして計測を行う.
このようにしてrdtscを用いてプログラムの実行速度を細かく測っていく.

.. code-block:: c

  static size_t sum = 0;
  static size_t cnt = 0;
  size_t before = rte_get_tsc_cycles ()
  //検査対象コード
  sum += rte_get_tsc_cycles () - before;
  cnt ++;
  if (cnt > 1000000)
  {
    printf ("latency: %zd \n", sum / cnt);
    cnt = sum = 0;
  }

この様に, 1Milion回の遅延をクロックレベルで測り, その平均値を値とする.
値のばらつきに関しては研究対象外とする.


